/** @license
 *
 *  Copyright (C) 2012 K. Arthur Endsley (kaendsle@mtu.edu)
 *  Michigan Tech Research Institute (MTRI)
 *  3600 Green Court, Suite 100, Ann Arbor, MI, 48105
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 *//**
 * @augments Wkt.Wkt
 * A framework-dependent flag, set for each Wkt.Wkt() instance, that indicates
 * whether or not a closed polygon geometry should be interpreted as a rectangle.
 */Wkt.Wkt.prototype.isRectangle=!1,Wkt.Wkt.prototype.construct={point:function(e,t){var n=t||this.components;return e=e||{},e.position=new google.maps.LatLng(n[0].y,n[0].x),new google.maps.Marker(e)},multipoint:function(e){var t,n,r;n=this.components,e=e||{},r=[];for(t=0;t<n.length;t+=1)r.push(this.construct.point(e,n[t]));return r},linestring:function(e,t){var n,r;r=t||this.components,e=e||{editable:!1},e.path=[];for(n=0;n<r.length;n+=1)e.path.push(new google.maps.LatLng(r[n].y,r[n].x));return new google.maps.Polyline(e)},multilinestring:function(e){var t,n,r;n=this.components,e=e||{editable:!1},e.path=[],r=[];for(t=0;t<n.length;t+=1)r.push(this.construct.linestring(e,n[t]));return r},box:function(e,t){var n=t||this.components;return e=e||{},e.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(n[0].y,n[0].x),new google.maps.LatLng(n[1].y,n[1].x)),new google.maps.Rectangle(e)},polygon:function(e,t){var n,r,i,s,o;i=t||this.components,e=e||{editable:!1},e.paths=[],s=[];for(n=0;n<i.length;n+=1){o=[];for(r=0;r<i[n].length-1;r+=1)o.push(new google.maps.LatLng(i[n][r].y,i[n][r].x));n!==0&&(e.reverseInnerPolygons==null||e.reverseInnerPolygons)&&o.reverse(),s.push(o)}return e.paths=e.paths.concat(s),this.isRectangle?function(){var e,t;e=new google.maps.LatLngBounds;for(t in s[0])s[0].hasOwnProperty(t)&&e.extend(s[0][t]);return new google.maps.Rectangle({bounds:e})}():new google.maps.Polygon(e)},multipolygon:function(e){var t,n,r;n=this.components,e=e||{editable:!1},e.path=[],r=[];for(t=0;t<n.length;t+=1)r.push(this.construct.polygon(e,n[t]));return r}},Wkt.Wkt.prototype.deconstruct=function(e,t,n){var r,i,s,n,o,u,a,f,l,c,h,p,d;l=google.maps.geometry.spherical.computeSignedArea;if(e.constructor===google.maps.LatLng)return h={type:"point",components:[{x:e.lng(),y:e.lat()}]},h.WKT=t?"":h.type.toUpperCase(),h.WKT+="("+e.lng()+" "+e.lat()+")",h;if(e.constructor===google.maps.Point)return h={type:"point",components:[{x:e.x,y:e.y}]},h.WKT=t?"":h.type.toUpperCase(),h.WKT+="("+h.components.x+" "+h.components.y+")",h;if(e.constructor===google.maps.Marker)return h={type:"point",components:[{x:e.getPosition().lng(),y:e.getPosition().lat()}]},h.WKT=t?"":h.type.toUpperCase(),h.WKT+="("+h.components.x+" "+h.components.y+")",h;if(e.constructor===google.maps.Polyline){o=[],u=[];for(i=0;i<e.getPath().length;i+=1)c=e.getPath().getAt(i),o.push({x:c.lng(),y:c.lat()}),u.push(c.lng()+" "+c.lat());return h={type:"linestring",components:o},h.WKT=t?"":h.type.toUpperCase(),h.WKT+="(("+u.join(",")+"))",h}if(e.constructor===google.maps.Polygon){a=[],f=[],n===undefined&&(n=function(){var t,r,i;return i=e.getPaths().length,i<=1?!1:i===2?l(e.getPaths().getAt(0))*l(e.getPaths().getAt(1))<0?!1:!0:(t=e.getPaths().getArray().map(function(e){return l(e)/Math.abs(l(e))}),t.indexOf(t[0])!==t.lastIndexOf(t[0])?(n=!0,!0):!1)}());for(i=0;i<e.getPaths().length;i+=1){c=e.getPaths().getAt(i),u=[],o=[];for(s=0;s<e.getPaths().getAt(i).length;s+=1)o.push({x:c.getAt(s).lng(),y:c.getAt(s).lat()}),u.push(c.getAt(s).lng()+" "+c.getAt(s).lat());c.getAt(c.length-1).equals(c.getAt(0))||(i%2!==0?o.unshift({x:c.getAt(c.length-1).lng(),y:c.getAt(c.length-1).lat()}):o.push({x:c.getAt(0).lng(),y:c.getAt(0).lat()}),u.push(c.getAt(0).lng()+" "+c.getAt(0).lat())),e.getPaths().length>1&&i>0&&(l(e.getPaths().getAt(i))>0&&l(e.getPaths().getAt(i-1))>0||l(e.getPaths().getAt(i))<0&&l(e.getPaths().getAt(i-1))<0&&!n)&&(o=[o],u=[u]),i%2!==0&&(o.reverse(),u.reverse()),a.push(o),f.push(u)}return h={type:n?"multipolygon":"polygon",components:a},h.WKT=t?"":h.type.toUpperCase(),h.WKT+="(("+f.join(",")+"))",h}if(e.constructor===google.maps.Circle){var v=e.getCenter(),m=e.getRadius();o=[],u=[];var g=Math.PI/180,y=180/Math.PI;m/=1609;var b=3963,w=32,E=m/b*y,S=E/Math.cos(v.lat()*g);for(var x=0;x<=w;x++){var T=Math.PI*(x/(w/2));d=v.lng()+S*Math.cos(T),p=v.lat()+E*Math.sin(T),o.push({x:d,y:p}),u.push(d+" "+p)}return h={type:"polygon",components:[o]},h.WKT=t?"":h.type.toUpperCase(),h.WKT+="(("+u.join(",")+"))",h}if(e.constructor===google.maps.Rectangle)return c=e.getBounds(),o=[],u=[],o.push({x:c.getSouthWest().lng(),y:c.getNorthEast().lat()}),u.push(o[0].x+" "+o[0].y),o.push({x:c.getNorthEast().lng(),y:c.getNorthEast().lat()}),u.push(o[1].x+" "+o[1].y),o.push({x:c.getNorthEast().lng(),y:c.getSouthWest().lat()}),u.push(o[2].x+" "+o[2].y),o.push({x:c.getSouthWest().lng(),y:c.getSouthWest().lat()}),u.push(o[3].x+" "+o[3].y),o.push({x:c.getSouthWest().lng(),y:c.getNorthEast().lat()}),u.push(o[4].x+" "+o[4].y),h={type:"polygon",isRectangle:!0,components:[o]},h.WKT=t?"":h.type.toUpperCase(),h.WKT+="(("+u.join(",")+"))",h;if(Wkt.isArray(e)){r=[];for(i=0;i<e.length;i+=1)r.push(this.deconstruct.call(this,e[i],!0,!0));return h={type:function(){var t,n=e[0].constructor;for(t=0;t<e.length;t+=1)if(e[t].constructor!==n)return"geometrycollection";switch(n){case google.maps.Marker:return"multipoint";case google.maps.Polyline:return"multilinestring";case google.maps.Polygon:return"multipolygon";default:return"geometrycollection"}}(),components:function(){var e,t;t=[],wktcomps=[];for(e=0;e<r.length;e+=1)r[e].components&&(t.push(r[e].components),wktcomps.push(r[e].WKT));return{comps:t,wktcomps:wktcomps}}()},h.WKT=h.type.toUpperCase()+"(",h.WKT+=h.components.wktcomps.join(","),h.components=h.components.comps,h.WKT+=")",h}console.log("The passed object does not have any recognizable properties.")};